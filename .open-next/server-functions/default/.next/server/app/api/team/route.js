(()=>{var a={};a.id=645,a.ids=[645],a.modules={3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7629:(a,b,c)=>{"use strict";c.d(b,{Rk:()=>m,dX:()=>k,wK:()=>n,wz:()=>j,yg:()=>l});var d=c(94634),e=c(16048),f=c(49695),g=c(80362),h=c(44999),i=c(50613);async function j(){let a=(await (0,h.UL)()).get("session");if(!a||!a.value)return null;let b=await (0,i.nr)(a.value);if(!b||!b.user||"number"!=typeof b.user.id||new Date(b.expires)<new Date)return null;let c=await f.db.select().from(g.users).where((0,d.Uo)((0,d.eq)(g.users.id,b.user.id),(0,d.kZ)(g.users.deletedAt))).limit(1);return 0===c.length?null:c[0]}async function k(a){let b=await f.db.select().from(g.teams).where((0,d.eq)(g.teams.stripeCustomerId,a)).limit(1);return b.length>0?b[0]:null}async function l(a,b){await f.db.update(g.teams).set({...b,updatedAt:new Date}).where((0,d.eq)(g.teams.id,a))}async function m(){let a=await j();if(!a)throw Error("User not authenticated");return await f.db.select({id:g.activityLogs.id,action:g.activityLogs.action,timestamp:g.activityLogs.timestamp,ipAddress:g.activityLogs.ipAddress,userName:g.users.name}).from(g.activityLogs).leftJoin(g.users,(0,d.eq)(g.activityLogs.userId,g.users.id)).where((0,d.eq)(g.activityLogs.userId,a.id)).orderBy((0,e.i)(g.activityLogs.timestamp)).limit(10)}async function n(){let a=await j();if(!a)return null;let b=await f.db.query.teamMembers.findFirst({where:(0,d.eq)(g.teamMembers.userId,a.id),with:{team:{with:{teamMembers:{with:{user:{columns:{id:!0,name:!0,email:!0}}}}}}}});return b?.team||null}},21820:a=>{"use strict";a.exports=require("os")},27910:a=>{"use strict";a.exports=require("stream")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29727:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page-experimental.runtime.prod.js")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},46803:(a,b,c)=>{"use strict";c.r(b),c.d(b,{patchFetch:()=>n,routeModule:()=>j,serverHooks:()=>m,workAsyncStorage:()=>k,workUnitAsyncStorage:()=>l});var d={};c.r(d),c.d(d,{GET:()=>i});var e=c(96559),f=c(48088),g=c(37719),h=c(7629);async function i(){let a=await (0,h.wK)();return Response.json(a)}let j=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/team/route",pathname:"/api/team",filename:"route",bundlePath:"app/api/team/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/gomolemokgatitsoe/projects/founderfinder/app/api/team/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:k,workUnitAsyncStorage:l,serverHooks:m}=j;function n(){return(0,g.patchFetch)({workAsyncStorage:k,workUnitAsyncStorage:l})}},46871:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route-experimental.runtime.prod.js")},49695:(a,b,c)=>{"use strict";c.d(b,{db:()=>i});var d=c(65761),e=c(43971),f=c(80362),g=c(97329);if(c.n(g)().config(),!process.env.POSTGRES_URL)throw Error("POSTGRES_URL environment variable is not set");let h=(0,e.A)(process.env.POSTGRES_URL),i=(0,d.f)(h,{schema:f})},50613:(a,b,c)=>{"use strict";c.d(b,{Nq:()=>j,nr:()=>i}),c(85663);var d=c(87806),e=c(77412),f=c(44999);let g=new TextEncoder().encode(process.env.AUTH_SECRET);async function h(a){return await new d.P(a).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("1 day from now").sign(g)}async function i(a){let{payload:b}=await (0,e.V)(a,g,{algorithms:["HS256"]});return b}async function j(a){let b=new Date(Date.now()+864e5),c={user:{id:a.id},expires:b.toISOString()},d=await h(c);(await (0,f.UL)()).set("session",d,{expires:b,httpOnly:!0,secure:!0,sameSite:"lax"})}},55511:a=>{"use strict";a.exports=require("crypto")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74998:a=>{"use strict";a.exports=require("perf_hooks")},78335:()=>{},80362:(a,b,c)=>{"use strict";c.r(b),c.d(b,{ActivityType:()=>u,activityLogs:()=>n,activityLogsRelations:()=>t,invitations:()=>o,invitationsRelations:()=>r,teamMembers:()=>m,teamMembersRelations:()=>s,teams:()=>l,teamsRelations:()=>p,users:()=>k,usersRelations:()=>q});var d=c(43402),e=c(50033),f=c(79252),g=c(29334),h=c(9253),i=c(63431),j=c(5614);let k=(0,d.cJ)("users",{id:(0,e.vX)("id").primaryKey(),name:(0,f.yf)("name",{length:100}),email:(0,f.yf)("email",{length:255}).notNull().unique(),passwordHash:(0,g.Qq)("password_hash").notNull(),role:(0,f.yf)("role",{length:20}).notNull().default("member"),createdAt:(0,h.vE)("created_at").notNull().defaultNow(),updatedAt:(0,h.vE)("updated_at").notNull().defaultNow(),deletedAt:(0,h.vE)("deleted_at")}),l=(0,d.cJ)("teams",{id:(0,e.vX)("id").primaryKey(),name:(0,f.yf)("name",{length:100}).notNull(),createdAt:(0,h.vE)("created_at").notNull().defaultNow(),updatedAt:(0,h.vE)("updated_at").notNull().defaultNow(),stripeCustomerId:(0,g.Qq)("stripe_customer_id").unique(),stripeSubscriptionId:(0,g.Qq)("stripe_subscription_id").unique(),stripeProductId:(0,g.Qq)("stripe_product_id"),planName:(0,f.yf)("plan_name",{length:50}),subscriptionStatus:(0,f.yf)("subscription_status",{length:20})}),m=(0,d.cJ)("team_members",{id:(0,e.vX)("id").primaryKey(),userId:(0,i.nd)("user_id").notNull().references(()=>k.id),teamId:(0,i.nd)("team_id").notNull().references(()=>l.id),role:(0,f.yf)("role",{length:50}).notNull(),joinedAt:(0,h.vE)("joined_at").notNull().defaultNow()}),n=(0,d.cJ)("activity_logs",{id:(0,e.vX)("id").primaryKey(),teamId:(0,i.nd)("team_id").notNull().references(()=>l.id),userId:(0,i.nd)("user_id").references(()=>k.id),action:(0,g.Qq)("action").notNull(),timestamp:(0,h.vE)("timestamp").notNull().defaultNow(),ipAddress:(0,f.yf)("ip_address",{length:45})}),o=(0,d.cJ)("invitations",{id:(0,e.vX)("id").primaryKey(),teamId:(0,i.nd)("team_id").notNull().references(()=>l.id),email:(0,f.yf)("email",{length:255}).notNull(),role:(0,f.yf)("role",{length:50}).notNull(),invitedBy:(0,i.nd)("invited_by").notNull().references(()=>k.id),invitedAt:(0,h.vE)("invited_at").notNull().defaultNow(),status:(0,f.yf)("status",{length:20}).notNull().default("pending")}),p=(0,j.K1)(l,({many:a})=>({teamMembers:a(m),activityLogs:a(n),invitations:a(o)})),q=(0,j.K1)(k,({many:a})=>({teamMembers:a(m),invitationsSent:a(o)})),r=(0,j.K1)(o,({one:a})=>({team:a(l,{fields:[o.teamId],references:[l.id]}),invitedBy:a(k,{fields:[o.invitedBy],references:[k.id]})})),s=(0,j.K1)(m,({one:a})=>({user:a(k,{fields:[m.userId],references:[k.id]}),team:a(l,{fields:[m.teamId],references:[l.id]})})),t=(0,j.K1)(n,({one:a})=>({team:a(l,{fields:[n.teamId],references:[l.id]}),user:a(k,{fields:[n.userId],references:[k.id]})}));var u=function(a){return a.SIGN_UP="SIGN_UP",a.SIGN_IN="SIGN_IN",a.SIGN_OUT="SIGN_OUT",a.UPDATE_PASSWORD="UPDATE_PASSWORD",a.DELETE_ACCOUNT="DELETE_ACCOUNT",a.UPDATE_ACCOUNT="UPDATE_ACCOUNT",a.CREATE_TEAM="CREATE_TEAM",a.REMOVE_TEAM_MEMBER="REMOVE_TEAM_MEMBER",a.INVITE_TEAM_MEMBER="INVITE_TEAM_MEMBER",a.ACCEPT_INVITATION="ACCEPT_INVITATION",a}({})},91645:a=>{"use strict";a.exports=require("net")},96487:()=>{},96559:(a,b,c)=>{"use strict";a.exports=c(46871)}};var b=require("../../../webpack-runtime.js");b.C(a);var c=a=>b(b.s=a),d=b.X(0,[243,117],()=>c(46803));module.exports=d})();